import{f as j,j as e,ay as v,aA as w,aC as S,z as L,D as b,aa as m,B as x,ao as E,aI as A,U as c,aJ as d,W as r,H as I,E as P,r as z,P as C,O as D}from"./index-De8AI2Zv.js";import{a as V}from"./index-BoNgdhHe.js";import{u as q}from"./useIsAuthenticated-e_Uob3F-.js";const B=j(e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"})),F=v({email:S().nonempty().email(),password:w("Password")}),H=()=>{const s=L(),{mutate:a,isPending:t,error:n}=b({mutationFn:async i=>await V(i),onSuccess:async()=>{await s.invalidateQueries({queryKey:["isAuthenticated"]}),await s.invalidateQueries({queryKey:["user"]})}});return{Login:a,isPending:t,error:n}};function Q(){const{Login:s,isPending:a}=H(),{state:t}=m(),n=x(),{control:i,setError:l,handleSubmit:p,formState:{isSubmitting:f,isValid:g}}=E({mode:"onTouched",resolver:A(F),defaultValues:{email:"",password:""}}),y=async h=>{await s(h,{onSuccess:()=>{n(t?.from||"/activities")},onError:u=>{Array.isArray(u)&&u.forEach(o=>{o.include("email")?l("email",{message:o}):o.include("password")&&l("password",{message:o})})}})};return e.jsxs(c,{component:"form",display:"flex",flexDirection:"column",gap:1,width:"100%",onSubmit:p(y),children:[e.jsx(d,{label:"Email",name:"email",control:i}),e.jsx(d,{type:"password",label:"Password",name:"password",control:i}),e.jsxs(c,{display:"flex",justifyContent:"space-between",children:[e.jsxs(r,{fontSize:"13px",color:"text.secondary",children:["Don't have an account?"," ",e.jsx(r,{component:I,to:"/register",color:"text.default",fontSize:"inherit",children:"Register"})]}),e.jsx(P,{variant:"contained",type:"submit",disabled:!g||f||a,children:"Login"})]})]})}function K(){const s=m(),a=x(),{isAuthenticated:t,isLoading:n}=q();return z.useEffect(()=>{s.pathname==="/login"&&t&&!n&&a(-1)},[s,t,a,n]),e.jsx(C,{elevation:3,sx:{py:3,px:4,mx:"auto",maxWidth:"740px"},children:e.jsxs(c,{display:"flex",flexDirection:"column",gap:1,alignItems:"center",justifyContent:"center",children:[e.jsx(B,{color:"secondary",sx:{fontSize:48}}),e.jsx(r,{variant:"h4",color:"text.secondary",fontWeight:600,children:"Login"}),e.jsx(D,{color:"secondary"}),e.jsx(Q,{})]})})}export{K as default};
